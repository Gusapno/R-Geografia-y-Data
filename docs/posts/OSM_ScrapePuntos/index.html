<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gabriel Ramírez">

<title>R, Geografía y Data - Webscrape de puntos de Open Street Map (OSM)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar"
  }
}</script>

<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="../../site_libs/jquery-1.12.4/jquery.min.js"></script>
<link href="../../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="../../site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="../../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="../../site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="../../site_libs/leaflet-binding-2.0.4.1/leaflet.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">R, Geografía y Data</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Buscar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Navegación de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Gusapno" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/Gabo06719007" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Webscrape de puntos de Open Street Map (OSM)</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">SIG</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Autor/a</div>
      <div class="quarto-title-meta-contents">
               <p>Gabriel Ramírez </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Fecha de publicación</div>
      <div class="quarto-title-meta-contents">
        <p class="date">2 de abril de 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenidos</h2>
   
  <ul>
  <li><a href="#obtención-de-datos-de-open-street-map-osm-mediante-webscraping" id="toc-obtención-de-datos-de-open-street-map-osm-mediante-webscraping" class="nav-link active" data-scroll-target="#obtención-de-datos-de-open-street-map-osm-mediante-webscraping">Obtención de datos de Open Street Map (OSM) mediante webscraping</a></li>
  <li><a href="#planteamiento-del-webscrape-con-rselenium" id="toc-planteamiento-del-webscrape-con-rselenium" class="nav-link" data-scroll-target="#planteamiento-del-webscrape-con-rselenium">Planteamiento del webscrape con RSelenium</a></li>
  <li><a href="#visualización-de-puntos-obtenidos" id="toc-visualización-de-puntos-obtenidos" class="nav-link" data-scroll-target="#visualización-de-puntos-obtenidos">Visualización de puntos obtenidos</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="obtención-de-datos-de-open-street-map-osm-mediante-webscraping" class="level1">
<h1>Obtención de datos de Open Street Map (OSM) mediante webscraping</h1>
<p>Open Street Map (OSM) es una base de datos geográfica gratis que es actualizada y mantenida de forma colaborativa. Estos datos son capturados con dispositivos GPS, ortofotografías y otras fuentes libres. Se distribuyen bajo la Licencia Abierta de Bases de Datos (ODbL). Esta licencia permite a los usuarios usar, compartir y modificar libremente la base de datos de forma que se mantiene la misma libertad para los demás.</p>
<p>En la página web de <a href="openstreetmap.org">Open Street Map</a> es posible buscar la ubicación de Instituciones. En este caso interesa conocer la ubicación de cada Municipalidad en los ochenta y dos cantones del Costa Rica. Para lograr esto, se cuenta con la capa de cantones de Costa Rica la cual ofrece la lista de cantones del país.</p>
<p>Se utilizará la librería <a href="https://cran.r-project.org/web/packages/RSelenium/index.html">RSelenium</a> <span class="citation" data-cites="RSelenium">(<a href="#ref-RSelenium" role="doc-biblioref">Harrison, 2022</a>)</span> la cual permite manejar un navegador web de forma nativa o remota. Con esta librería es posible automatizar tareas en los navegadores. Para lograr obtener la ubicación de las municipalidades, es posible automatizar la tarea de buscar todas las municipalidades y sus respectivas coordenadas.</p>
<p>Esto también es posible mediante la utilización de la API (Application Programming Interface) pero el soporte en lenguaje R no es muy flexible. Con la librería <a href="https://cran.r-project.org/web/packages/osmdata/vignettes/osmdata.html"><code>osmdata</code></a> <span class="citation" data-cites="osmdata">(<a href="#ref-osmdata" role="doc-biblioref">Padgham et&nbsp;al., 2017</a>)</span> se pueden obtener datos de la siguiente forma:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(osmdata) <span class="co"># </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf) <span class="co">#</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Capa de cantones de Costa Rica, se usará como bounding box</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>cant.sp <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">read_sf</span>(<span class="st">"sp/LimiteCantonal5K_.shp"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Se transforma a WGS84</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>bbox_wgs84 <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">st_transform</span>(cant.sp, <span class="at">crs =</span> <span class="st">"WGS84"</span>))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Se extraen los datos con los límites de la capa cant.sp</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>datos_muni <span class="ot">&lt;-</span> <span class="fu">opq</span>(<span class="at">bbox =</span> bbox_wgs84) <span class="sc">%&gt;%</span> <span class="co"># "Overpass" query</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">add_osm_feature</span>(<span class="at">key =</span> <span class="st">"amenity"</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">value =</span> <span class="st">'townhall'</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>                        <span class="at">value_exact =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                <span class="fu">osmdata_sf</span>()</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Los datos extraídos poseen puntos, polígonos y multipolígonos.</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># en nuestro caso interesan los puntos</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>puntos <span class="ot">&lt;-</span> datos_muni<span class="sc">$</span>osm_points</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Se transforma a UTF-8 ya que posee otra codificación</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>puntos <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(puntos, is.character, </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>                           <span class="at">.funs =</span> <span class="cf">function</span>(x){<span class="fu">return</span>(<span class="st">`</span><span class="at">Encoding&lt;-</span><span class="st">`</span>(x, <span class="st">"UTF-8"</span>))})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Al revisar los datos, se aprecia que existen muchos valores sin nombre y que algunos de ellos no corresponden a municipalidades. Para observar los registros con nombre se eliminan los que no poseen nombre. Estos son algunos de los resultados:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se remueven los valores en blanco</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tabla <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(puntos, <span class="fu">grepl</span>(<span class="st">""</span>,name))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">osm_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">addr.city</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">addr.street</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Concejo Municipal Distrito Paquera</td>
<td style="text-align: left;">Paquera</td>
<td style="text-align: left;">Calle Central</td>
<td style="text-align: left;">townhall</td>
</tr>
<tr class="even">
<td style="text-align: left;">Concejo Municipal Distrito Colorado</td>
<td style="text-align: left;">Colorado</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">townhall</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Municipalidad de La Cruz</td>
<td style="text-align: left;">La Cruz</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">townhall</td>
</tr>
<tr class="even">
<td style="text-align: left;">Concejo Municipal Distrito Lepanto</td>
<td style="text-align: left;">Lepanto</td>
<td style="text-align: left;">Vía 21</td>
<td style="text-align: left;">townhall</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Concejo Municipal Distrito Cóbano</td>
<td style="text-align: left;">Cóbano</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">townhall</td>
</tr>
<tr class="even">
<td style="text-align: left;">Concejo Municipal Distrito Tucurrique</td>
<td style="text-align: left;">Tucurrique</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">townhall</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Se aprecia que los resultados no incluyen todas las municipalidades del país. Por su parte los datos de polígonos y multipolígonos si poseen información sobre las municipalidades pero el proceso para obtener una ubicación puntual asociada a cada municipalidad podría ser un poco tedioso. Ante esto, es posible plantear un webscrape con RSelenium en el que se busque cada Municipalidad del país en la página web de OSM y en caso que exista más de un resultado, se utilizaría el más similar a lo deseado. Para evaluar la similitud de un string con otro, se utiliza la librería <a href="https://cran.r-project.org/web/packages/stringdist/index.html">stringdist</a> <span class="citation" data-cites="stringdist">(<a href="#ref-stringdist" role="doc-biblioref">Loo, 2014</a>)</span> el cual ofrece un puntaje de similitud entre dos strings.</p>
<p>Después de realizar una búsqueda se aprecia que la localización puntual del elemento es incluída en la estructura de la página, lo cual se puede usar para extraer las coordenadas.</p>
<div id="fig-html" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/Screenshot 2024-04-07 003033.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figura&nbsp;1: HTML de la página web</figcaption>
</figure>
</div>
<p>En un resultado de búsqueda, las municipalidades pueden ser denominadas “Palacio Municipal” por lo que si no se encuentra similitud con “Municipalidad de (Cantón)” se intenta con Palacio Municipal.</p>
</section>
<section id="planteamiento-del-webscrape-con-rselenium" class="level1">
<h1>Planteamiento del webscrape con RSelenium</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringdist) <span class="co"># Comparar similitud de strings</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSelenium) <span class="co"># RSelenium</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(seleniumPipes) <span class="co"># Implementa W3C webdriver</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(netstat) <span class="co"># Para el free_port()</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Empezar el servidor</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>rs_driver_object <span class="ot">&lt;-</span> <span class="fu">rsDriver</span>(<span class="at">browser =</span> <span class="st">'chrome'</span>, <span class="co"># Se utilizará Google Chrome</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">chromever =</span> <span class="st">'latest'</span>, <span class="co"># Versión de Chrome</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="co"># No incluir mensajes de estado</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">port =</span> <span class="fu">free_port</span>(), <span class="co"># Se utiliza un puerto libre</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">check =</span> <span class="cn">TRUE</span>) <span class="co"># Checar si hay nuevas versiones</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># crear un objeto cliente</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>remDr <span class="ot">&lt;-</span> rs_driver_object<span class="sc">$</span>client</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Se navega a la página de interés</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>remDr<span class="sc">$</span><span class="fu">navigate</span>(<span class="st">'https://www.openstreetmap.org'</span>) <span class="co"># </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para poder automatizar la búsqueda de todas las municipalidades es necesario conocer como referirse al cuadro de búsqueda. Al revisar en la página, el xpath completo del cuadro de búsqueda es <code>/html/body/div/div[1]/div[1]/form[1]/div/div[1]/div/input[1]</code>, con lo cual se puede interactuar con el mismo de la siguiente forma:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se asigna el xpath a una variable para simplificar el código</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>xpath_cuadro <span class="ot">&lt;-</span> <span class="st">"/html/body/div/div[1]/div[1]/form[1]/div/div[1]/div/input[1]"</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Se busca en el web driver</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>cuadro_busqueda <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="st">"xpath"</span>,xpath_cuadro)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Se envía texto al elemento pero debe ser en formato lista</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>cuadro_busqueda<span class="sc">$</span><span class="fu">sendKeysToElement</span>(<span class="fu">list</span>(<span class="fu">paste0</span>(<span class="st">"Municipalidad de "</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                                                cant.sp<span class="sc">$</span>canton[<span class="dv">1</span>], <span class="st">" Costa Rica"</span>)))</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># El texto se puede limpiar de la siguiente forma:</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>cuadro_busqueda<span class="sc">$</span><span class="fu">clearElement</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para realizar la búsqueda se realiza un proceso similar (se identifica el xpath pero se da click en el elemento). También es posible escribir la indicación de click inmediatamente de la siguiente forma:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se envía texto al elemento pero debe ser en formato lista</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>cuadro_busqueda<span class="sc">$</span><span class="fu">sendKeysToElement</span>(<span class="fu">list</span>(<span class="fu">paste0</span>(<span class="st">"Municipalidad Heredia"</span>)))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># xpath para buscar el elemento</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>click_busqueda <span class="ot">&lt;-</span> <span class="st">'//*[@id="sidebar"]/div[1]/form[1]/div/div[1]/div/input[2]'</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Indicaciones para dar click</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="st">"xpath"</span>,click_busqueda)<span class="sc">$</span><span class="fu">clickElement</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-resultados-busqueda" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/Screenshot 2024-04-07 192634.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Con esta búsqueda, se obtienen dos resultados (lo cual varía según el área de búsqueda) pero el resultado deseado es específicamente la “Municipalidad de Heredia”. Para identificar mediante código el resultado deseado, es posible comparar los resultados obtenidos con el resultado deseado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># xpath para identificar los resultados visibles</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>resultados_busqueda <span class="ot">&lt;-</span> <span class="st">"/html/body/div/div[1]/div[5]/div[2]/ul/li/a"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Se utiliza "findElements" ya que se desean todos los elementos</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>cl_result <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElements</span>(<span class="st">"xpath"</span>,resultados_busqueda)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se obtiene una lista del tamaño de la cantidad de resultados visibles (podrían ser más si se presiona en More Results). Para acceder al nombre de la municipalidad, separarlo de la dirección y compararlo con lo deseado es posible realizar el siguiente procedimiento:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>nombres_resultado <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">0</span>, <span class="at">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(nombres_resultado) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Nombre_completo"</span>,<span class="st">"Nombre"</span>,<span class="st">"Similitud"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cl_result)) {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Se añade al dataframe</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  nombres_resultado[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">as.character</span>(cl_result[[i]]<span class="sc">$</span><span class="fu">getElementText</span>())</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Se divide por la coma y se selecciona el primer resultado</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  nombres_resultado[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">str_split</span>(nombres_resultado[i,<span class="dv">1</span>],<span class="st">","</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Similitud</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  nombres_resultado[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">stringsim</span>(<span class="st">"Municipalidad Heredia"</span>,nombres_resultado[i,<span class="dv">2</span>])</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">X</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Nombre_completo</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Nombre</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Similitud</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Municipalidad de Barva, Calle 2 Nicolás Aguilar, El Calvario, Barva, Cantón Barva, Heredia Province, 40201, Costa Rica</td>
<td style="text-align: left;">Municipalidad de Barva</td>
<td style="text-align: right;">0.7272727</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Municipalidad de San Rafael, Calle 35, La Terraza, San Rafael, Cantón San Rafael, Heredia Province, 40501, Costa Rica</td>
<td style="text-align: left;">Municipalidad de San Rafael</td>
<td style="text-align: right;">0.5925926</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">Municipalidad de Heredia, Avenida Central Paseo de la Cultura, Oriente, Corazón de Jesús, Heredia, Cantón Heredia, Heredia Province, 40101, Costa Rica</td>
<td style="text-align: left;">Municipalidad de Heredia</td>
<td style="text-align: right;">0.8750000</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">Municipalidad de San Isidro, Calle Central, Cristo Rey, San Isidro, Cantón San Isidro, Heredia Province, 40601, Costa Rica</td>
<td style="text-align: left;">Municipalidad de San Isidro</td>
<td style="text-align: right;">0.5925926</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Municipalidad de Belén, Calle 152, San Vicente, San Antonio, Cantón Belén, Heredia Province, 40701, Costa Rica</td>
<td style="text-align: left;">Municipalidad de Belén</td>
<td style="text-align: right;">0.7272727</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">Municipalidad de Santo Domingo, Calle Central, Santo Domingo, Cantón San Pablo, Heredia Province, 40901, Costa Rica</td>
<td style="text-align: left;">Municipalidad de Santo Domingo</td>
<td style="text-align: right;">0.5333333</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Se aprecia que el tercer resultado es el que posee mayor similitud con el string deseado, por tanto la información se extraería del mismo. Ya que se identificó el resultado deseado, es posible explorar como obtener las coordenadas del mismo. Para esto al revisar <a href="#fig-html">Figura&nbsp;1</a> se aprecia que existe un atributo asociado a las coordenadas del elemento de búsqueda asociado. Para extraer las coordenadas, se puede realizar el siguiente procedimiento:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para saber cual es el de mayor similitud</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>res_similar <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">which</span>(<span class="fu">tolower</span>(nombres_resultado<span class="sc">$</span>Similitud) <span class="sc">&gt;</span> <span class="fl">0.85</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Se encuentra la coordenada y se muestra</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>lon <span class="ot">&lt;-</span> cl_result[[res_similar]]<span class="sc">$</span><span class="fu">getElementAttribute</span>(<span class="st">"data-lon"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Se encuentra la coordenada y se muestra</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">&lt;-</span> cl_result[[res_similar]]<span class="sc">$</span><span class="fu">getElementAttribute</span>(<span class="st">"data-lat"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"La longitud de la Municipalidad de Heredia es"</span>,lon))</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"La latitud de la Municipalidad de Heredia es"</span>,lat))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "La longitud de la Municipalidad de Heredia es -84.1162254"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "La latitud de la Municipalidad de Heredia es 9.9989845"</code></pre>
</div>
</div>
<p>Con esto es posible iterar por todos los nombres de cantón y guardar las coordenadas para cada municipalidad. Se plantea de la siguiente manera:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre de columna para la tabla de salida</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ncol_municipalidades <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Canton"</span>,<span class="st">"Nombre"</span>,<span class="st">"Tipo"</span>,<span class="st">"X"</span>,<span class="st">"Y"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataframe con cantidad de nombre de columna igual a ncol_municipalidades</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">0</span>, <span class="at">ncol =</span> <span class="fu">length</span>(ncol_municipalidades)))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Se asignan los nombres de columna</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> ncol_municipalidades</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Se asignan xpath para evitar ruido en el código</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>cuadro_busqueda <span class="ot">&lt;-</span> <span class="st">'/html/body/div/div[1]/div[1]/form[1]/div/div[1]/div/input[1]'</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>click_busqueda <span class="ot">&lt;-</span> <span class="st">'//*[@id="sidebar"]/div[1]/form[1]/div/div[1]/div/input[2]'</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>resultados_busqueda <span class="ot">&lt;-</span> <span class="st">"/html/body/div/div[1]/div[5]/div[2]/ul/li/a"</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># La iteración va de 1 al número de cantones (82)</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cant.sp<span class="sc">$</span>canton)) {</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(r)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Limpiar el cuadro de búsqueea</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="st">"xpath"</span>,cuadro_busqueda)<span class="sc">$</span><span class="fu">clearElement</span>()</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Se selecciona el cuadro de busqueda</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  busqueda <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="st">"xpath"</span>,cuadro_busqueda)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Se envía el texto al cuadro de texto</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  busqueda<span class="sc">$</span><span class="fu">sendKeysToElement</span>(<span class="fu">list</span>(<span class="fu">paste0</span>(<span class="st">"Municipalidad de "</span>, </span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>                                                cant.sp<span class="sc">$</span>canton[i], <span class="st">" Costa Rica"</span>)))</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Se da click al botón de buscar</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="st">"xpath"</span>,click_busqueda)<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">3</span>)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Se revisa si el texto de "Resultados" está presente </span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Lo cual es indicador de que hubo más de un resultado</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">try</span>(<span class="fu">assign</span>(<span class="st">"r"</span>,<span class="fu">length</span>(remDr<span class="sc">$</span><span class="fu">findElements</span>(<span class="st">"xpath"</span>,resultados_busqueda))),<span class="at">silent =</span> T)</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Si "r" es igual a 0 se borra (ya que no hubieron mas resultados)</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">5</span>)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># el string deseado</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(r <span class="sc">&lt;</span> 2L){</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(r)</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    resultado_similar <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>    cl_result <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElements</span>(<span class="st">"xpath"</span>,resultados_busqueda)</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">"r"</span>) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cantidad de resultados</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(r)</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variable para clickear</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>    cl_result <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElements</span>(<span class="st">"xpath"</span>,resultados_busqueda)</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Se crea una tabla</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>    lista_resultados <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">0</span>, <span class="at">ncol =</span> <span class="dv">4</span>))</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(lista_resultados) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Resultado_Completo"</span>,<span class="st">"Tipo"</span>,<span class="st">"Resultado_Split"</span>,<span class="st">"Score"</span>)</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it_result <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>r) {</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Se itera sobre la tabla creada para añadirle los resultados</span></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>      lista_resultados[it_result,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(cl_result[[it_result]]<span class="sc">$</span><span class="fu">getElementText</span>())</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>      lista_resultados[it_result,<span class="dv">2</span>] <span class="ot">&lt;-</span> cl_result[[it_result]]<span class="sc">$</span><span class="fu">getElementAttribute</span>(<span class="st">"data-prefix"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>      lista_resultados[it_result,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">str_split</span>(lista_resultados[it_result,<span class="dv">1</span>],<span class="st">","</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Este string puede mejorar</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>      lista_resultados[it_result,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">stringsim</span>(<span class="fu">paste0</span>(<span class="st">"Municipalidad "</span>,cant.sp<span class="sc">$</span>canton[i]),</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>                                          lista_resultados[it_result,<span class="dv">3</span>])</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Si el puntaje de similitud es mayor a 0.85 se procede</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">max</span>(lista_resultados<span class="sc">$</span>Score) <span class="sc">&gt;</span> <span class="fl">0.85</span>) {</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Se busca la palabra similar</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>    resultado_similar <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">which</span>(<span class="fu">tolower</span>(lista_resultados<span class="sc">$</span>Score) <span class="sc">&gt;</span> <span class="fl">0.85</span> <span class="sc">&amp;</span></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>                                            lista_resultados<span class="sc">$</span>Tipo <span class="sc">==</span> <span class="st">"Town Hall"</span>))[[<span class="dv">1</span>]]</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Si el puntaje de similitud es menor a 0.85 se procede</span></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">max</span>(lista_resultados<span class="sc">$</span>Score) <span class="sc">&lt;</span> <span class="fl">0.85</span>) {</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Se busca el resultado Palacio Municipal</span></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>    resultado_similar <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">grepl</span>(<span class="st">"palacio municipal"</span>,</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">tolower</span>(lista_resultados<span class="sc">$</span>Resultado)) <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Se añade el nombre del cantón</span></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>  df[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> cant.sp<span class="sc">$</span>canton[i]</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dirección</span></span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>  df[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(cl_result[[resultado_similar]]<span class="sc">$</span><span class="fu">getElementText</span>())</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Tipo</span></span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>  df[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> cl_result[[resultado_similar]]<span class="sc">$</span><span class="fu">getElementAttribute</span>(<span class="st">"data-prefix"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Se añade la coordenada</span></span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>  df[i,<span class="dv">4</span>] <span class="ot">&lt;-</span> cl_result[[resultado_similar]]<span class="sc">$</span><span class="fu">getElementAttribute</span>(<span class="st">"data-lon"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Se añade la coordenada</span></span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>  df[i,<span class="dv">5</span>] <span class="ot">&lt;-</span> cl_result[[resultado_similar]]<span class="sc">$</span><span class="fu">getElementAttribute</span>(<span class="st">"data-lat"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Iteración "</span>,i,<span class="st">" Municipalidad del cantón de "</span>, cant.sp<span class="sc">$</span>canton[i]))</span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(df,<span class="st">"output/csv/Puntos_Municipalidades.csv"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualización-de-puntos-obtenidos" class="level1">
<h1>Visualización de puntos obtenidos</h1>
<p>Los resultados obtenido pueden ser plasmados en un mapa para comprobar las ubicaciones. Esto se puede realizar con la librería <code>leaflet</code> <span class="citation" data-cites="leaflet">(<a href="#ref-leaflet" role="doc-biblioref">Cheng et&nbsp;al., 2021</a>)</span>. Se configura de forma que al dar click en cada punto es posible ver la dirección asociada al mismo (aunque se puede mostrar otra información pero en este caso se mostrará la dirección).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng =</span> <span class="fu">as.numeric</span>(df<span class="sc">$</span>X),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lat =</span> <span class="fu">as.numeric</span>(df<span class="sc">$</span>Y), <span class="at">popup =</span> df<span class="sc">$</span>Nombre)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-ebe112e256a91406e233" style="width:100%;height:464px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-ebe112e256a91406e233">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[9.4313011,8.9787376,9.3730051,9.5293179,9.6588391,9.6533286,9.8474914,9.8392836,8.6490816,8.625428,8.8200104,9.1727709,9.6254121,9.6099467,9.6836891,9.8627578,9.8988373,9.7990851,9.9083746,9.8453066,9.8649524,9.9766004,9.8932479,9.9065681,9.916119,9.8687632,9.9033714,9.9921702,9.9083058,9.9157082,9.9111368,9.9314192,9.9205608,9.9164333,9.933115,9.9951323,9.9332302,9.9454901,9.9625138,9.9357862,10.1418239,9.9794189,10.017275,9.9609623,9.9916759,9.9766492,9.9805793,9.9792162,9.9947803,10.0879097,9.9989845,10.0588739,10.0029246,10.0141245,10.0204734,10.0163374,10.0374418,10.0563598,10.0768707,10.0734221,10.0975154,10.0918813,10.0892557,10.0984019,10.0767448,10.2688335,10.1849558,10.2089207,10.2815454,10.2029127,10.3225271,10.4269051,10.4714406,10.4500138,10.4468764,10.3462149,10.5263698,10.6702022,11.0305628,10.6305165,10.8989493,11.0741161],[-84.1625859,-83.5326761,-83.7027928,-84.3620995,-84.0217673,-83.969649,-84.3144733,-83.8657837,-82.9417679,-83.1538376,-82.9702222,-83.3356079,-82.8512749,-84.6220874,-84.0418109,-84.093278,-84.0651069,-84.1614287,-84.441089,-83.9388298,-83.9206174,-84.8363739,-83.7464017,-83.6838138,-84.2425464,-83.9042933,-84.1002972,-83.033404,-83.9852255,-84.0356256,-84.5239488,-84.0947618,-84.1401695,-83.8107725,-84.1811359,-85.251632,-84.0526443,-84.0564446,-84.07847,-84.5227677,-85.4537856,-84.3804411,-84.2102523,-84.0476161,-84.6677694,-84.0074502,-84.0912337,-84.1853459,-84.0982371,-84.4703381,-84.1162254,-85.4178646,-84.1520906,-84.1000717,-84.1249174,-84.0552705,-84.1597384,-84.4334521,-84.2452944,-84.3120071,-84.3781496,-84.729126,-84.3482451,-83.5057025,-83.2895739,-85.5710831,-84.3924786,-83.6817057,-84.9578056,-83.7891709,-84.4307648,-85.0917943,-84.9690782,-84.0134593,-85.5517098,-84.2135451,-85.2553833,-84.8214634,-84.7172541,-85.438814,-85.0148108,-85.6344879],10,null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2},null,null,["Municipalidad de Quepos, Calle Central, Los Ángeles, El Cerro, Quepos, Cantón Quepos, Puntarenas Province, 60601, Costa Rica","Municipalidad de Osa, Transversal 3, Montreal, Canadá, Puerto Cortés, Cantón Osa, Puntarenas Province, 60501, Costa Rica","Municipalidad de Pérez Zeledón, Avenida 2, Hospital Viejo, San Isidro de El General, Cantón Pérez Zeledón, San Jose Province, 11901, Costa Rica","Municipalidad de Parrita, Carretera Pacífica Fernández Oreamuno, Buena Nota, Parrita, Cantón Parrita, Puntarenas Province, 60901, Costa Rica","Municipalidad de Tarrazú, Avenida Central, Corea, San Marcos, Cantón Tarrazú, San Jose Province, 10501, Costa Rica","Municipalidad de Dota, Avenida 1, El Invu, Santa María, Cantón Dota, San Jose Province, 11701, Costa Rica","Municipalidad de Puriscal, Avenida 1, Santa Cecilia, Santiago, Cantón Puriscal, San Jose Province, 10401, Costa Rica","Municipalidad de Paraíso, Avenida 0, La Joya, Paraíso, Cantón Paraíso, Cartago Province, 30201, Costa Rica","Municipalidad de Corredores, Avenida 7, San Juan, Neily, Corredor, Cantón Corredores, Puntarenas Province, 61001, Costa Rica","Municipalidad de Golfito, Avenida 1, Pueblo Civil, Golfito, Cantón Golfito, Puntarenas Province, 60701, Costa Rica","Municipalidad de Coto Brus, Vía 613, María Auxiliadora, San Vito, Cantón Coto Brus, Puntarenas Province, 60801, Costa Rica","Municipalidad de Buenos Aires, Avenida 1, San Martín, Buenos Aires, Cantón Buenos Aires, Puntarenas Province, 60301, Costa Rica","Municipalidad de Talamanca, Avenida Central, Cruce de Bribri, Bribri, Bratsi, Cantón Talamanca, Limón Province, 70401, Costa Rica","Municipalidad de Garabito, Avenida Pastor Díaz, Los Cholos, Jacó, Cantón Garabito, Puntarenas Province, 61101, Costa Rica","Municipalidad de León Cortés Castro, Avenida 1, San Francisco, San Pablo, Cantón León Cortés Castro, San Jose Province, 12001, Costa Rica","Municipalidad de Aserrí, Calle 2, Barrio Lomas de Aserrí, Aserrí, Cantón Aserrí, San Jose Province, 10601, Costa Rica","Municipalidad de Desamparados, Calle 2, Palogrande, Desamparados, Cantón Desamparados, San Jose Province, 10301, Costa Rica","Municipalidad de Acosta;Banco de Costa Rica, Avenida 1, Loyola, San Ignacio, Cantón Acosta, San Jose Province, 11201, Costa Rica","Municipalidad de Turrubares, Calle 2, Imas, San Pablo, Cantón Turrubares, San Jose Province, 11601, Costa Rica","Municipalidad de El Guarco, Avenida 48, Victoria, El Tejar, Cantón El Guarco, Cartago Province, 30801, Costa Rica","Municipalidad de Cartago, Avenida Central, Cartago, Oriental, Cantón Cartago, Cartago Province, 30101, Costa Rica","Municipalidad de Puntarenas, Calle 9, Puntarenas, Cantón Puntarenas, Puntarenas Province, 60101, Costa Rica","Municipalidad de Jiménez, Calle 2, Santa Cecilia, Juan Viñas, Cantón Jiménez, Cartago Province, 30401, Costa Rica","Municipalidad de Turrialba, Calle 1, Cabiria, Turrialba, Cantón Turrialba, Cartago Province, 30501, Costa Rica","Municipalidad de Mora, Calle 4, Michoacán, Colón, Cantón Mora, San Jose Province, 10701, Costa Rica","Municipalidad de Oreamuno, Avenida 9A, Barreal, San Rafael, Cantón Oreamuno, Cartago Province, 30701, Costa Rica","Municipalidad de Alajuelita, Avenida 68, Mojados, Alajuelita, Cantón San José, San Jose Province, 10111, Costa Rica","Municipalidad de Limón, Calle 8, Bella Vista, Limón, Cantón Limón, Limón Province, 70101, Costa Rica","Municipalidad de La Unión, Avenida Central, Fátima, Tres Ríos, Cantón La Unión, Cartago Province, 30301, Costa Rica","Municipalidad de Curridabat, Calle 93, El Dorado, Curridabat, Cantón Curridabat, San Jose Province, 11801, Costa Rica","Municipalidad de Orotina, Avenida Central, El Molino, Orotina, Cantón Orotina, Alajuela Province, 20901, Costa Rica","Municipalidad de San José, 0227, Avenida 10 San Martín, Silos, San José, Hospital, Cantón San José, San Jose Province, 10103, Costa Rica","Municipalidad de Escazú, Calle 134, Faroles, Escazú, Cantón Escazú, San Jose Province, 10201, Costa Rica","Municipalidad de Alvarado, Calle 6, Lourdes, Pacayas, Cantón Alvarado, Cartago Province, 30601, Costa Rica","Municipalidad de Santa Ana, Calle Central, Barrio Obando, Santa Ana, Cantón Santa Ana, San Jose Province, 10901, Costa Rica","Municipalidad de Nandayure, Calle 1, Bello Horizonte, Carmona, Cantón Nandayure, Provincia Guanacaste, 50901, Costa Rica","Municipalidad de Montes de Oca, Avenida 1, Roosevelt, San Pedro, Cantón Montes de Oca, San Jose Province, 11501, Costa Rica","Municipalidad de Goicoechea, Avenida 31, La Maravilla, Guadalupe, Cantón Goicoechea, San Jose Province, 10801, Costa Rica","Municipalidad de Tibás, Avenida 63, Las Rosas, San Juan, Cantón Tibás, San Jose Province, 11301, Costa Rica","Municipalidad de San Mateo, Calle 2, Barrio Corazón de Jesús, San Mateo, Cantón San Mateo, Alajuela Province, 20401, Costa Rica","Municipalidad de Nicoya, Avenida 2, Nicoya, Cantón Nicoya, Provincia Guanacaste, 50201, Costa Rica","Municipalidad de Atenas, Calle Central Doctor Julio César Ovares, Santa Cecilia, Atenas, Cantón Atenas, Alajuela Province, 20501, Costa Rica","Municipalidad de Alajuela, Avenida Central Juan Manuel López del Corral, Arroyo, Alajuela, Cantón Alajuela, Alajuela Province, 20101, Costa Rica","Municipalidad de Moravia, Avenida 63, Saprissa, San Vicente, Cantón Moravia, San Jose Province, 11401, Costa Rica","Municipalidad de Esparza, Calle 2, La Riviera, Esparza, Espíritu Santo, Cantón Esparza, Puntarenas Province, 60201, Costa Rica","Municipalidad de Vázquez de Coronado, Avenida 93, Los Álamos, San Isidro, Cantón Vázquez de Coronado, San Jose Province, 11101, Costa Rica","Municipalidad de Santo Domingo, Calle Central, Santo Domingo, Cantón San Pablo, Heredia Province, 40901, Costa Rica","Municipalidad de Belén, Calle 152, San Vicente, San Antonio, Cantón Belén, Heredia Province, 40701, Costa Rica","Municipalidad de San Pablo, Avenida 4, San Pablo, Cantón San Pablo, Heredia Province, 40901, Costa Rica","Municipalidad de San Ramón, Calle 1A, San José, San Ramón, Cantón San Ramón, Alajuela Province, 20201, Costa Rica","Municipalidad de Heredia, Avenida Central Paseo de la Cultura, Oriente, Corazón de Jesús, Heredia, Cantón Heredia, Heredia Province, 40101, Costa Rica","Municipalidad de Hojancha, Avenida 1, Barrio La Gran Vía, Hojancha, Cantón Hojancha, Provincia Guanacaste, 51101, Costa Rica","Municipalidad de Flores, Avenida Central, Santa Marta, San Joaquín, Cantón Flores, Heredia Province, 40801, Costa Rica","Municipalidad de San Rafael, Calle 35, La Terraza, San Rafael, Cantón San Rafael, Heredia Province, 40501, Costa Rica","Municipalidad de Barva, Calle 2 Nicolás Aguilar, El Calvario, Barva, Cantón Barva, Heredia Province, 40201, Costa Rica","Municipalidad de San Isidro, Calle Central, Cristo Rey, San Isidro, Cantón San Isidro, Heredia Province, 40601, Costa Rica","Municipalidad de Santa Bárbara, Calle 2, Tropezón, Santa Bárbara, Cantón Santa Bárbara, Heredia Province, 40401, Costa Rica","Municipalidad de Palmares, Calle Central, El Carmen, Palmares, Cantón Palmares, Alajuela Province, 20701, Costa Rica","Municipalidad de Poás, Avenida Central, Los Ángeles, San Pedro, Cantón Poás, Alajuela Province, 20801, Costa Rica","Municipalidad de Grecia, Calle 2 Lucas Fernández, Chavarría, Jiménez, Grecia, Cantón Grecia, Alajuela Province, 20301, Costa Rica","Municipalidad de Naranjo, Avenida Central, Caña Dura, Naranjo, Cantón Naranjo, Alajuela Province, 20601, Costa Rica","Municipalidad de Montes de Oro, Calle 1, Lidio Blanco, Miramar, Cantón Montes de Oro, Puntarenas Province, 60401, Costa Rica","Municipalidad de Sarchí, Calle 2, Sam Pérez 1, Sarchí Norte, Cantón Sarchí, Alajuela Province, 21201, Costa Rica","Municipalidad de Siquirres, Calle 2, El Triunfo, Siquirres, Cantón Siquirres, Limón Province, 70301, Costa Rica","Municipalidad de Matina, Calle 1, Matinita, Matina, Cantón Matina, Limón Province, 70501, Costa Rica","Municipalidad de Santa Cruz, Corredor Chorotega, Tamarindo, Santa Cruz, Cantón Santa Cruz, Provincia Guanacaste, 50301, Costa Rica","Municipalidad de Zarcero, Avenida Central, San Pablo, Zarcero, Cantón Zarcero, Alajuela Province, 21101, Costa Rica","Municipalidad de Guácimo, Calle 1, Barrio Corazón de Jesús, Guácimo, Cantón Guácimo, Limón Province, 70601, Costa Rica","Municipalidad de Abangares, Avenida 1, El Invu, Las Juntas, Cantón Abangares, Provincia Guanacaste, 50701, Costa Rica","Municipalidad de Pococí, Calle 5, Belén, Guápiles, Cantón Pococí, Limón Province, 70201, Costa Rica","Municipalidad de San Carlos, Avenida 2, La Cruz, Quesada, Cantón San Carlos, Alajuela Province, 21001, Costa Rica","Municipalidad de Cañas, Calle Central, Barrio San Pedro, Cañas, Cantón Cañas, Provincia Guanacaste, 50601, Costa Rica","Municipalidad de Tilarán, Calle 4, El Carmen, Tilarán, Cantón Tilarán, Provincia Guanacaste, 50801, Costa Rica","Municipalidad de Sarapiquí, Corredor Noratlántico, Yure, Puerto Viejo, Cantón Sarapiquí, Heredia Province, 41001, Costa Rica","Municipalidad de Carrillo, Avenida 3, Los Ángeles, Filadelfia, Cantón Carrillo, Provincia Guanacaste, 50501, Costa Rica","Municipalidad de Río Cuarto, Calle Central, Gosen, Río Cuarto, Cantón Río Cuarto, Alajuela Province, 21601, Costa Rica","Municipalidad de Bagaces, Calle 2, Villa Nueva, Bagaces, Cantón Bagaces, Provincia Guanacaste, 50401, Costa Rica","Municipalidad de Guatuso, Avenida 8, Nazareth, San Rafael, Cantón Guatuso, Alajuela Province, 21501, Costa Rica","Municipalidad de Los Chiles, Avenida Central, Pueblo Nuevo, Los Chiles, Cantón Los Chiles, Alajuela Province, 21401, Costa Rica","Municipalidad de Liberia, Calle 2, Los Ángeles, Liberia, Cantón Liberia, Provincia Guanacaste, 50101, Costa Rica","Municipalidad de Upala, Avenida 1, Don Chu, Upala, Cantón Upala, Alajuela Province, 21301, Costa Rica","Municipalidad de La Cruz, Calle Central, Barrio Corazón de Jesús, La Cruz, Cantón La Cruz, Provincia Guanacaste, 51001, Costa Rica"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[8.625428,11.0741161],"lng":[-85.6344879,-82.8512749]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">Referencias</h2><div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list">
<div id="ref-leaflet" class="csl-entry" role="listitem">
Cheng, J., Karambelkar, B., &amp; Xie, Y. (2021). <em>leaflet: Create Interactive Web Maps with the JavaScript ’Leaflet’ Library</em>. <a href="https://CRAN.R-project.org/package=leaflet">https://CRAN.R-project.org/package=leaflet</a>
</div>
<div id="ref-RSelenium" class="csl-entry" role="listitem">
Harrison, J. (2022). <em>RSelenium: R Bindings for ’Selenium WebDriver’</em>. <a href="https://CRAN.R-project.org/package=RSelenium">https://CRAN.R-project.org/package=RSelenium</a>
</div>
<div id="ref-stringdist" class="csl-entry" role="listitem">
Loo, M. P. J. van der. (2014). <em>The stringdist package for approximate string matching</em>. <em>6</em>, 111-122. <a href="https://CRAN.R-project.org/package=stringdist">https://CRAN.R-project.org/package=stringdist</a>
</div>
<div id="ref-osmdata" class="csl-entry" role="listitem">
Padgham, M., Rudis, Bob., Lovelace, R., &amp; Salmon, M. (2017). <em>osmdata</em>. <em>2</em>, 305. <a href="https://doi.org/10.21105/joss.00305">https://doi.org/10.21105/joss.00305</a>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>